# Multifractal analysis of multispecies spatial distributions - Spatial patterns simulations

I generate different a spatial patterns to compare SRSDq SADdq and SAD

```{r setup, eval=T }
load(".RData")

simul  <- F # variable to perform or not the simulations

oldcd <-getwd()
source("R/Neutral_fun.r")

# Set the location of the binary 
#
mfBin <- "~/Dropbox/cpp/SpatialAnalysis/mfsba" # /mfSBA /multiSpeciesSBA

require(pander)
panderOptions('table.split.table',Inf)

```

# Banded pattern of species with uniform  SAD 256 side

First generate a pattern with  SAR z=1 using simply bands of species z=0.5 because I am using area as Borda-de-Agua instead of side.

```{r simul_z1, eval=T,echo=F,message=F,warning=F}
setwd("Simul")

DqF <- compMethods_UniformSAD(8,256)

DqF <- rbind(DqF,compMethods_UniformSAD(64,256))

DqF <- rbind(DqF,compMethods_UniformSAD(256,256))

# Analizing this last it means that the scaling is broken at side 16
#  
#Dq2<- calcDq_multiSBA(fname1,"q.sed 16 1024 20 E",mfBin,T)
#Dq2$Type <- "rnzDqSAD16-512"
#Dq3<- rbind(Dq3,Dq2)
#
##Dq2<- calcDq_multiSBA(fname1,"q.sed 2 16 20 E",mfBin,T)
#Dq2$Type <- "rnzDqSAD2-16"
#Dq3<- rbind(Dq3,Dq2)
#plotDq(Dq3,"Type")

pandoc.table(DqF[DqF$R.Dq<0.8,],caption="R2<0.8")
setwd(oldcd)
```

* For SRS the positive part seems to reflect the equal SAD and the negative the spatial pattern


# Banded pattern 64 species 512 side

To see if there is any efect of side 

```{r simul_z1_512, eval=T,echo=F,message=F,warning=F}
setwd("Simul")



DqF <- rbind(DqF,compMethods_UniformSAD(64,512))


setwd(oldcd)
```

Thus DqSAD works in the range 2-8 2-16 2-32 depending on the number of species

# Now simulate an image with logseries SAD with 8, 64 & 256 species

# Test logseries SAD side = 256 

```{r simul_ls_256, eval=T,echo=F,message=F,warning=F}
setwd("Simul")

DqF <- rbind(DqF,compMethods_FisherSAD(8,256))

DqF <- rbind(DqF,compMethods_FisherSAD(64,256))

DqF <- rbind(DqF,compMethods_FisherSAD(256,256))

setwd(oldcd)

```

# Test logseries SAD side=512 

```{r simul_ls_512b, eval=T,echo=F,message=F,warning=F}
setwd("Simul")

DqF <- rbind(DqF,compMethods_FisherSAD(8,512,F))

DqF <- rbind(DqF,compMethods_FisherSAD(64,512,F))

DqF <- rbind(DqF,compMethods_FisherSAD(256,512,F))

setwd(oldcd)
rm(Dq1,Dq2,spa)

```

# Simulate with logseries and the neutral model

```{r simul_neu_256, eval=T,echo=F,message=F,warning=F}
setwd("Simul")


DqF <- rbind(DqF,compMethods_NeutralSAD(8,256,T))


DqF <- rbind(DqF,compMethods_NeutralSAD(64,256,T))


DqF <- rbind(DqF,compMethods_NeutralSAD(256,256,T))
setwd(oldcd)
rm(nsp,side,spa)
save.image()

```

